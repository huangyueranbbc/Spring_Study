define("common:widget/util/sms.js",function(t,i,e){function n(t){t=t||{},this.main=$(t.main),this.state="",this.maxTimer=t.timer||60,this.type=t.type||"",this.prepare()}var s=t("common:widget/util/ejson.js"),a="disabled",r="enabled";n.prototype={constructor:n,prepare:function(){this._orginText=this.main.val()},send:function(t,i){var e=this;return this._state===a?s.reject({msg:"不能重复点击"}):s.post(t,{data:i}).then(function(t){return e.disable(),e.startCount(),t})},disable:function(){this._state=a,this.main.addClass("n-disabled")},enable:function(){this._state=r,this.main.removeClass("n-disabled")},startCount:function(){var t=this;t.count=this.maxTimer,this.intervalTimer&&clearInterval(this.intervalTimer),this.intervalTimer=setInterval(function(){t.update(),t.endCount()},1e3)},endCount:function(){this.count--,this.intervalTimer&&1===this.count&&(clearInterval(this.intervalTimer),this.reset(),this.enable())},update:function(){this.main.val(this.count+"秒后重发")},reset:function(){this.count=this.maxTimer,this.main.val(this._orginText)},isEnable:function(){return this._state===r},validate:function(t,i){return s.post(t,{data:i})},dispose:function(){clearInterval(this.intervalTimer),this.reset()}},i.create=function(t,i){return"object"==typeof t?i=t:(i=i||{},i.main=t),new n(i)},i.SMS=n,e.exports=i});